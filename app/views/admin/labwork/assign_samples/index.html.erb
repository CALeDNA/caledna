<% content_for(:title) { 'Assign Samples' } %>
<% content_for(:javascript) { javascript_include_tag 'admin/batch_actions.js' } %>

<header class="main-content__header" role="banner">
  <h1 class="main-content__page-title">
    <%= content_for(:title) %>
  </h1>
</header>

<section class="main-content__body">
  <div class="assign-samples-menu">
    <%= select(:sample, :processor_id, @processors, {include_blank: 'Select processor'}) %>
    <a data-action="assign_samples" class="batch-action btn btn-default">
      Assign
    </a>
  </div>

  <table class="no-auto-link">
    <tr>
      <th><%= check_box_tag :rows %></th>
      <th>Barcode</th>
      <th>Field Data Project</th>
      <th>Lat/Lng</th>
    </tr>
    <% @samples.each do |sample| %>
    <tr>
      <td><%= check_box_tag :row, sample.id, false, class: "row" %> </td>
      <td><%= link_to sample.barcode, admin_sample_path(sample.id) %></td>
      <td><%= link_to sample.field_data_project.name, admin_field_data_project_path(sample.field_data_project) %></td>
      <td><%= sample.latitude %> / <%= sample.longitude %></td>
    </tr>
    <% end %>
  </table>
</section>

<input type="hidden" data-data="" id="associated_data" >
<%= paginate @samples %>

<script>
  (function(){
    var selectEl = document.getElementById('sample_processor_id');
    var associatedDataEl = document.getElementById('associated_data');

    selectEl.addEventListener('change', (e) => {
      associatedDataEl.dataset.data = JSON.stringify({"processor_id": e.target.value })
    })

  })()
</script>
