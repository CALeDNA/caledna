<% list_view = params[:view] == 'list' %>
<% inat_source = params[:source] == 'inat' %>
<style>
.section-content {
  margin-bottom: 2rem;
}
</style>

<% if @project.present? %>
  <h1><%= @project.name %></h1>
  <%= render partial: "research_projects/pillar_point/submenu" %>

  <h2>
    <%= @page.title%>
    <% if current_researcher %>
      <a class="btn btn-primary" href="<%= "#{research_projects_pillar_point_path}/edit?section=#{params[:section] || 'intro'}" %>">Edit</a>
    <% end %>
  </h2>

  <div class="section-content"><%= sanitize @page.body %></div>

  <% if params[:section] == 'occurrence_comparsion' %>
    <%= render partial: "research_projects/pillar_point/occurrence_comparsion" %>
  <% elsif params[:section] == 'gbif_breakdown' %>
    <%= render partial: "research_projects/pillar_point/gbif_breakdown" %>
  <% elsif params[:section] == 'interactions' %>
    <%= render partial: "research_projects/pillar_point/interactions" %>
  <% elsif params[:view] == 'list' %>
    <%= render partial: "research_projects/pillar_point/intro" %>
    <%= render partial: "research_projects/pillar_point/samples_menu" %>
    <%= render partial: "research_projects/pillar_point/list",
      locals: { occurrences: @occurrences, asvs_count: @asvs_count }  %>
  <% elsif params[:section] == 'common_taxa' %>
    <%= render partial: "research_projects/pillar_point/common_taxa" %>
  <% elsif params[:section] == 'area_diversity' %>
    <%= render partial: "research_projects/pillar_point/area_diversity" %>
  <% elsif params[:section] == 'edna_gbif_comparison' %>
    <%= render partial: "research_projects/pillar_point/edna_gbif_comparison" %>
  <% elsif params[:section] == 'detection_frequency' %>
    <%= render partial: "research_projects/pillar_point/detection_frequency" %>
  <% elsif params[:section] == 'source_comparison_all' %>
    <%= render partial: "research_projects/pillar_point/source_comparison_all" %>
  <% elsif params[:section] == 'networks' %>
    <%= render partial: "research_projects/pillar_point/networks" %>
  <% else %>
    <%= render partial: "research_projects/pillar_point/intro" %>
    <%= render partial: "research_projects/pillar_point/samples_menu" %>
    <%= render partial: "research_projects/pillar_point/map", locals: { samples: @samples,
      asvs_count: @asvs_count,
      inat_observations: @inat_observations,
      initial_lat: nil, initial_lng: nil } %>
  <% end %>
<% end %>
